{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2 class="my-4">{{ swagger.name }}</h2>
    <h4>Endpoints</h4>
    
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Path</th>
                <th>Method</th>
                <th>Fields</th>
            </tr>
        </thead>
        <tbody>
            {% for endpoint in endpoints %}
                <tr id="endpoint-{{ endpoint.id }}">  <!-- Add an ID for each endpoint -->
                    <td>{{ endpoint.path }}</td>
                    <td><span class="badge bg-primary">{{ endpoint.method }}</span></td>
                    <td>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                    <th>Anonymization</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for field in endpoint.fields %}
                                    <tr>
                                        <td>{{ field.name }}</td>
                                        <td>{{ field.type }}</td>
                                        <td>{{ field.description }}</td>
                                        <td>{{ field.anonymization.anonymization_method.name if field.anonymization else "Not Set" }}</td>
                                        <td>
                                            <a href="{{ url_for('edit_anonymization', field_id=field.id) }}" class="btn btn-sm btn-warning">Edit</a>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <a href="{{ url_for('index') }}" class="btn btn-secondary">Back</a>
</div>
{% endblock %}